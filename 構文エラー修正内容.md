# 構文エラー修正内容

## 問題の原因

VBAアドイン（.xlam）で以下の問題が発生していました：

1. **マクロがAlt+F8の一覧に表示されない**
2. **VBAの「構文エラー」によりプロジェクト全体がコンパイル不能**

## 修正内容

### 1. `土地調書_出力実行`関数のエラーハンドリング修正

**問題：**
- `On Error Resume Next`の後に`On Error GoTo EH`を直接使用していた
- エラーハンドリングのリセットが不適切だった

**修正：**
```vba
' 修正前
On Error Resume Next
For i = LBound(transferNames) To UBound(transferNames)
    ' ...
Next i
On Error GoTo EH

' 修正後
On Error Resume Next
For i = LBound(transferNames) To UBound(transferNames)
    ' ...
Next i
On Error GoTo 0  ' エラーハンドリングをリセット

' その後、Select Case文の前にエラーハンドリングを設定
On Error GoTo EH
Select Case formatType
    ' ...
End Select
```

### 2. `Excel_複数シート出力実行`関数の宣言修正

**問題：**
- 行継続文字（`_`）の前後のスペースや見えない文字が原因の可能性

**修正：**
```vba
' 修正前
Public Sub Excel_複数シート出力実行(ByVal sheetNames() As String, _
                                   ByVal outDirUi As String, _
                                   ByVal fileNameUi As String, _
                                   Optional ByVal targetWb As Workbook = Nothing)

' 修正後（行継続文字の前にスペースを確保、インデントを統一）
Public Sub Excel_複数シート出力実行( _
    ByVal sheetNames() As String, _
    ByVal outDirUi As String, _
    ByVal fileNameUi As String, _
    Optional ByVal targetWb As Workbook = Nothing)
```

## VBAの構文エラーの一般的な原因

1. **行継続文字（`_`）の問題**
   - 行継続文字の前にスペースが必要
   - 行継続文字の後にコメントや文字があってはならない
   - 全角スペースが混入している可能性

2. **エラーハンドリングの問題**
   - `On Error Resume Next`の後に`On Error GoTo 0`でリセットする必要がある
   - `On Error GoTo EH`の前にエラーハンドリングをリセットする

3. **文字列リテラルの問題**
   - 文字列リテラルが正しく閉じられていない
   - 全角引用符が混入している可能性

4. **見えない文字の問題**
   - 全角スペースや見えない文字が混入している
   - 文字エンコーディングの問題

## 確認事項

修正後、以下を確認してください：

1. **VBAエディタでコンパイルエラーが解消されているか**
   - VBAエディタで「デバッグ」→「コンパイル」を実行
   - エラーが表示されないことを確認

2. **マクロ一覧に表示されるか**
   - Alt+F8でマクロ一覧を開く
   - 表示されない場合は、`Application.Run`で呼び出す（正常な動作）

3. **他ブックから呼び出せるか**
   ```vba
   Application.Run "'アドイン名.xlam'!PDF_エクスポート_フォーム表示"
   ```

## 注意事項

- アドイン（.xlam）のマクロは、デフォルトでマクロ一覧に表示されないことがあります
- これは正常な動作であり、`Application.Run`で呼び出すことができます
- 構文エラーが解消されれば、コンパイル可能になり、マクロも正常に動作します

