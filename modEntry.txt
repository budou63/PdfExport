Option Explicit

'============================================================
' PDF/Excel出力アドイン - エントリーポイント
' Alt+F8のマクロ一覧に表示される入口マクロ
'============================================================

'=== 出力形式（modPdfExportから参照） ===
' 【修正】フォームからも参照できるように、modPdfExportのEnumを参照
' VBAではPublic Enumはプロジェクト全体で参照可能だが、
' フォームから参照する場合は明示的に型を指定する必要がある場合があるため、
' ここで型エイリアスを定義（実際の定義はmodPdfExportにある）
' 注意: VBAではEnumの再定義はできないため、modPdfExport.ExportFormatTypeを直接使用

'----------------------------------------
' メイン入口マクロ（Alt+F8に表示される）
'----------------------------------------

' PDF/Excel出力フォームを起動
' Alt+F8のマクロ一覧から実行可能
Public Sub PdfExport_起動()
    Call modPdfExport.PDF_エクスポート_フォーム表示
End Sub

'----------------------------------------
' QAT（クイックアクセスツールバー）用の短い名前マクロ
'----------------------------------------

' 短い名前版（QAT登録用）
Public Sub PE()
    Call modPdfExport.PDF_エクスポート_フォーム表示
End Sub

'----------------------------------------
' テスト・動作確認用マクロ
'----------------------------------------

' アドインが正常に動作しているか確認するテストマクロ
' Alt+F8のマクロ一覧から実行可能
Public Sub PdfExport_テスト()
    Dim msg As String
    Dim addinName As String
    
    addinName = ThisWorkbook.Name
    msg = "PDF/Excel出力アドイン" & vbCrLf & vbCrLf & _
          "アドイン名: " & addinName & vbCrLf & _
          "バージョン: 1.0" & vbCrLf & vbCrLf & _
          "正常に動作しています。" & vbCrLf & vbCrLf & _
          "メイン機能を起動するには、" & vbCrLf & _
          "「PdfExport_起動」を実行してください。"
    
    MsgBox msg, vbInformation, "PDF/Excel出力アドイン - 動作確認"
End Sub

'----------------------------------------
' フォームからの呼び出し用ラッパー（英数字のみ、モジュール修飾不要）
'----------------------------------------

' 複数シートを1つのExcelファイルにまとめて保存（値貼り付け）
' 【修正】フォームからの呼び出し用ラッパー（モジュール修飾不要で確実に呼べる）
' sheetNames: シート名の配列
' outDirUi: 出力先フォルダ（UIで指定された値）
' fileNameUi: ファイル名（UIで指定された値、空なら自動生成）
' targetWb: 出力対象ブック（Nothingの場合はActiveWorkbookを使用）
Public Sub PdfExport_ExcelMultiExport(ByVal sheetNames() As String, ByVal outDirUi As String, ByVal fileNameUi As String, Optional ByVal targetWb As Workbook = Nothing)
    ' modPdfExportの実処理を呼ぶ（モジュール修飾なしで直接呼べる）
    Call modPdfExport.Excel_MultiSheetExport(sheetNames, outDirUi, fileNameUi, targetWb)
End Sub

' 指定シート・ページ範囲でPDF出力
' 【修正】フォームからの呼び出し用ラッパー（モジュール修飾不要で確実に呼べる）
' sheetName: シート名
' fromPage: 開始ページ（Variant、全ページの場合はEmpty）
' toPage: 終了ページ（Variant、全ページの場合はEmpty）
' allPages: 全ページ出力フラグ
' outDirUi: 出力先フォルダ（UIで指定された値）
' fileNameUi: ファイル名（UIで指定された値、空なら自動生成）
' targetWb: 出力対象ブック（Nothingの場合はActiveWorkbookを使用）
Public Sub PdfExport_PdfExport(ByVal sheetName As String, _
                                ByVal fromPage As Variant, _
                                ByVal toPage As Variant, _
                                ByVal allPages As Boolean, _
                                ByVal outDirUi As String, _
                                ByVal fileNameUi As String, _
                                Optional ByVal targetWb As Workbook = Nothing)
    ' modPdfExportの実処理を呼ぶ（モジュール修飾なしで直接呼べる）
    Call modPdfExport.PDF_出力実行(sheetName, fromPage, toPage, allPages, outDirUi, fileNameUi, targetWb)
End Sub

' 指定シートをExcel形式（値貼り付け）で保存
' 【修正】フォームからの呼び出し用ラッパー（モジュール修飾不要で確実に呼べる）
' sheetName: シート名
' outDirUi: 出力先フォルダ（UIで指定された値）
' fileNameUi: ファイル名（UIで指定された値、空なら自動生成）
' targetWb: 出力対象ブック（Nothingの場合はActiveWorkbookを使用）
Public Sub PdfExport_ExcelExport(ByVal sheetName As String, _
                                  ByVal outDirUi As String, _
                                  ByVal fileNameUi As String, _
                                  Optional ByVal targetWb As Workbook = Nothing)
    ' modPdfExportの実処理を呼ぶ（モジュール修飾なしで直接呼べる）
    Call modPdfExport.Excel_出力実行(sheetName, outDirUi, fileNameUi, targetWb)
End Sub

